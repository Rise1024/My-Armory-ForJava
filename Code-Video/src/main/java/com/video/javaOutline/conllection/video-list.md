### List视频文案
兄弟们,我整理一份Java知识大纲
之后每天用一两分钟的时间
学习或者复习一下面试中经常遇到的问题
从Java集合、数据结构和算法
到网络通信
以及一些常用场景的方案设计
今天我们先从Java集合的List接口开始
从代码层面看一下面试中经常问到的
ArrayList扩容机制
这是ArrayList在JDK1.8的源码
扩容机制也就是数组容量的变化
扩容我们首先要考虑两个问题
第一个什么时候扩容?
第二个是如何扩容?
带着问题我们看一下add方法的第一行代码
ensureCapacity方法
它的传参是size+1
咱们以无参构造方法为例
size是元素数量初始化时值为0
那么传进来的值就是1
我们点进来看一下
这里调用了ensureExplicitCapacity方法
这里就是是否扩容的核心
传的参数是calculateCapacity方法
calculateCapacity方法就是计算
容器中数组所需的最小长度
这里传了两个参数
一个是存放元素的数组
一个minCapacity
ArrayList初始化
传进来的elementData肯定是空数组
minCapacity是我们得到的数值1
判断elementData是否是null数组
如果是就会走if这个判断，
经过一个取大值的操作，
与默认的DEFAULT_CAPACITY 进行比对，
DEFAULT_CAPACITY 值是10
自然第一次添加元素返回的就是最小空间就是10。

下面就是判断是否扩容
当刚计算的数组最小长度大于数组长度时就扩容
刚才我们看到返回的是10
肯定大于目前的数组长度
因为它还是一个空数组
所以要走扩容
grow()方法是真正扩容处理
扩容的核心就是第二行代码
代码使用了移位运算
为什么说是扩容到1.5倍呢?

因为右移1就是除2的1次幂
假如当前容量是10那就是10+10/2也就是15

但是第一次添加元素
数组的长度是0
经过右移运算还是0
所以在判断后走赋值逻辑
新数组长度变成了10
然后创建一个新的数组
将之前的元素复制到新数组上
第一次扩容完成

我们来总结一下

add 第 1 个元素的时候，
数组还为空，
数组容量会扩容到默认容量10

add 第 2 到 10 个元素的时候：
elementData长度经过第一次扩容已经变成了10
所以不会走扩容

add第11个元素的时候，
进入扩容
经过右移1运算等于15，
是原来数组容量的1.5倍
以此类推
以上就是ArrayList的扩容机制
兄弟们,
你们知道为什么选择1.5倍的扩容速度吗
可以思考一下
拜拜

### 相关图片
![img_1.png](image/img.png)





